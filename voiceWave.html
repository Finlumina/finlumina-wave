<!DOCTYPE html>
<html>
  <head>
    <style>
      body {
        margin: 0;
        background: transparent;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
      }
      #dots {
        display: flex;
      }
      .dot {
        width: 6px;
        height: 16px;
        background-color: red;
        margin: 0 4px;
        border-radius: 3px;
        transform: scaleY(1);
        opacity: 0.4;
        transition: transform 0.2s ease, opacity 0.2s ease;
      }
    </style>
  </head>
  <body data-animate="false">
    <div id="dots">
      <div class="dot" id="dot1"></div>
      <div class="dot" id="dot2"></div>
      <div class="dot" id="dot3"></div>
    </div>

    <script>
      const dots = [
        document.getElementById("dot1"),
        document.getElementById("dot2"),
        document.getElementById("dot3")
      ];
      let interval;

      function startWave() {
        if (interval) return;
        interval = setInterval(() => {
          dots.forEach((dot, i) => {
            setTimeout(() => {
              dot.style.transform = "scaleY(1.5)";
              dot.style.opacity = "1";
            }, i * 100);
            setTimeout(() => {
              dot.style.transform = "scaleY(1)";
              dot.style.opacity = "0.4";
            }, i * 100 + 300);
          });
        }, 600);
      }

      function stopWave() {
        clearInterval(interval);
        interval = null;
        dots.forEach(dot => {
          dot.style.transform = "scaleY(1)";
          dot.style.opacity = "0.4";
        });
      }

      const observer = new MutationObserver(() => {
        const shouldAnimate = document.body.getAttribute("data-animate") === "true";
        if (shouldAnimate) {
          startWave();
        } else {
          stopWave();
        }
      });

      observer.observe(document.body, { attributes: true, attributeFilter: ["data-animate"] });

      // Trigger immediately on load if needed
      if (document.body.getAttribute("data-animate") === "true") {
        startWave();
      }
    </script>
  </body>
</html>
