<script>
  const dots = document.querySelectorAll(".dot");
  let animation;

  function startAnimation() {
    clearInterval(animation);
    animation = setInterval(() => {
      dots.forEach((dot, i) => {
        setTimeout(() => {
          dot.style.transform = "scaleY(1.6)";
          dot.style.opacity = "1";
        }, i * 100);
        setTimeout(() => {
          dot.style.transform = "scaleY(1)";
          dot.style.opacity = "0.5";
        }, i * 100 + 300);
      });
    }, 600);
  }

  function stopAnimation() {
    clearInterval(animation);
    dots.forEach(dot => {
      dot.style.transform = "scaleY(1)";
      dot.style.opacity = "0.5";
    });
  }

  const customElement = document.body;

  const observer = new MutationObserver(() => {
    const value = customElement.getAttribute("data-animate");
    if (value === "true") {
      startAnimation();
    } else {
      stopAnimation();
    }
  });

  observer.observe(customElement, { attributes: true });
  stopAnimation();
</script>
